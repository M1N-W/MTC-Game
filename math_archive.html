<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå + AI Tutor Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏° MathJax ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏õ‡∏•‡∏á LaTeX ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans Thai', sans-serif;
            background-color: #fcfbf9;
            color: #4a4a4a;
        }
        .symbol-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .symbol-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 20px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.05);
        }
        .quiz-mode .meaning, .quiz-mode .name-en, .quiz-mode .desc-text {
            filter: blur(8px);
            opacity: 0.2;
            transition: all 0.3s ease;
        }
        .quiz-mode .symbol-card:hover .meaning, .quiz-mode .symbol-card:hover .name-en, .quiz-mode .symbol-card:hover .desc-text {
            filter: blur(0);
            opacity: 1;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 900px;
            margin-left: auto;
            margin-right: auto;
            height: 320px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container { height: 380px; }
        }
        .ai-content ul { list-style-type: disc; margin-left: 1.5rem; margin-bottom: 0.75rem; }
        .ai-content ol { list-style-type: decimal; margin-left: 1.5rem; margin-bottom: 0.75rem; }
        .ai-content strong { font-weight: 700; color: #b45309; }
        .ai-content p { margin-bottom: 0.75rem; }
        
        .loading-dots:after {
            content: ' .';
            animation: dots 1.5s steps(5, end) infinite;
        }
        @keyframes dots {
            0%, 20% { content: ' .'; }
            40% { content: ' ..'; }
            60% { content: ' ...'; }
            80%, 100% { content: ' ....'; }
        }
        mjx-container { font-size: 110% !important; }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header Section -->
    <header class="bg-white/80 backdrop-blur-md border-b border-stone-200 sticky top-0 z-30 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3">
            <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                <div class="flex items-center gap-2">
                    <span class="text-3xl">üìê</span>
                    <div>
                        <h1 class="text-xl font-bold text-stone-800 leading-none">Math Explorer Pro</h1>
                        <p class="text-[10px] uppercase tracking-widest text-amber-600 font-bold mt-1">AI Integrated System ‚ú®</p>
                    </div>
                </div>
                <div class="flex items-center gap-3">
                    <button id="quizToggle" class="flex items-center gap-2 px-4 py-2 rounded-xl bg-stone-100 hover:bg-stone-200 text-stone-600 font-semibold transition-all text-xs border border-stone-200">
                        <span id="quizIcon">üëÅÔ∏è</span>
                        <span id="quizText">‡πÇ‡∏´‡∏°‡∏î‡∏ó‡πà‡∏≠‡∏á‡∏à‡∏≥ (Quiz Mode)</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 w-full space-y-8">
        <!-- AI Welcome Section -->
        <section class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <div class="lg:col-span-2 bg-gradient-to-br from-amber-50 to-orange-50 border border-amber-100 p-6 rounded-2xl shadow-sm relative overflow-hidden">
                <div class="relative z-10">
                    <h2 class="text-xl font-bold text-amber-900 mb-2 flex items-center gap-2">
                        <span>‚ú®</span> ‡∏¢‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏î‡πâ‡∏ß‡∏¢ Gemini AI
                    </h2>
                    <p class="text-amber-800/80 text-sm leading-relaxed mb-4">
                        ‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡∏Ç‡∏∏‡∏°‡∏û‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å <strong>Gemini AI</strong> ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏ß‡∏¢‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏ó‡∏≤‡∏á‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå ‡∏ô‡πâ‡∏≠‡∏á‡πÜ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏´‡∏°‡∏î "‡∏ñ‡∏≤‡∏° AI" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                    </p>
                    <div class="flex flex-wrap gap-2">
                        <span class="px-3 py-1 bg-white/60 rounded-full text-[11px] font-bold text-amber-700 border border-amber-200">‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏á‡πà‡∏≤‡∏¢</span>
                        <span class="px-3 py-1 bg-white/60 rounded-full text-[11px] font-bold text-amber-700 border border-amber-200">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏à‡∏£‡∏¥‡∏á</span>
                        <span class="px-3 py-1 bg-white/60 rounded-full text-[11px] font-bold text-amber-700 border border-amber-200">‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢</span>
                    </div>
                </div>
                <div class="absolute -bottom-4 -right-4 opacity-10 text-8xl grayscale">ü§ñ</div>
            </div>
            
            <div class="bg-white border border-stone-200 p-6 rounded-2xl shadow-sm flex flex-col justify-center items-center text-center">
                <p class="text-xs text-stone-400 uppercase font-bold tracking-tighter mb-2">Current AI Model</p>
                <h3 id="roadmapTitle" class="text-lg font-bold text-stone-800 mb-3">‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ ‚ú®</h3>
                <button onclick="generateRoadmap()" id="categoryRoadmapBtn" class="w-full py-2.5 px-4 bg-stone-800 hover:bg-stone-900 text-white rounded-xl text-sm font-bold transition-all flex items-center justify-center gap-2 group">
                    <span class="group-hover:rotate-12 transition-transform">‚ú®</span> ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏ï‡∏¥‡∏ß‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ô‡∏µ‡πâ
                </button>
            </div>
        </section>

        <!-- Roadmap Result Section -->
        <section id="roadmapSection" class="hidden bg-stone-900 text-stone-200 p-6 rounded-2xl shadow-lg border border-stone-800 relative overflow-hidden">
            <div class="absolute top-0 right-0 p-4 opacity-10 text-6xl">üó∫Ô∏è</div>
            <div class="flex justify-between items-start mb-4 relative z-10">
                <h3 class="text-lg font-bold text-amber-400 flex items-center gap-2">
                    <span>üöÄ</span> AI Roadmap: <span id="roadmapCategoryName" class="text-white">General</span>
                </h3>
                <button onclick="closeRoadmap()" class="text-stone-400 hover:text-white transition-colors">‚úï</button>
            </div>
            <div id="roadmapResult" class="text-sm leading-relaxed space-y-3 relative z-10 ai-content"></div>
        </section>

        <!-- Category Filter -->
        <section class="bg-white border border-stone-200 p-5 rounded-2xl shadow-sm">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-base font-bold text-stone-800 flex items-center gap-2">
                    <span>üîç</span> ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà + ‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
                </h2>
                <span id="modelLabel" class="text-[9px] font-bold bg-amber-100 text-amber-700 px-2.5 py-1 rounded-full">GEMINI-1.5-PRO</span>
            </div>
            <div class="space-y-3">
                <div id="categoryContainer" class="flex flex-wrap gap-2"></div>
                <input id="searchInput" type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå... (‡πÄ‡∏ä‡πà‡∏ô integral, log, sin)" class="w-full px-4 py-2.5 border border-stone-200 rounded-lg text-sm focus:ring-2 focus:ring-amber-300 focus:border-amber-400 outline-none transition-all">
            </div>
        </section>

        <!-- Symbol Grid -->
        <section>
            <div id="emptyState" class="hidden text-center py-16">
                <span class="text-6xl mb-4 inline-block">üîç</span>
                <p class="text-stone-400 font-medium text-sm">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>
            </div>
            <div id="gridContainer" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4"></div>
        </section>

        <!-- Statistics Chart -->
        <section class="bg-white border border-stone-200 p-6 rounded-2xl shadow-sm">
            <h2 class="text-base font-bold text-stone-800 mb-4 flex items-center gap-2">
                <span>üìä</span> ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà
            </h2>
            <div class="chart-container">
                <canvas id="distributionChart"></canvas>
            </div>
        </section>
    </main>

    <!-- AI Modal -->
    <div id="aiModal" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-40 flex items-center justify-center p-4">
        <div id="aiModalContent" class="bg-white rounded-2xl max-w-3xl w-full max-h-[80vh] overflow-hidden shadow-2xl transform scale-95 opacity-0 transition-all duration-300">
            <div class="bg-gradient-to-r from-amber-500 to-orange-500 p-6 text-white flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <span id="modalSymbolIcon" class="text-4xl">‚àë</span>
                    <div>
                        <h3 id="modalTitle" class="text-xl font-bold">Summation (‡∏ú‡∏•‡∏£‡∏ß‡∏°)</h3>
                        <p class="text-xs text-amber-100 mt-1">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö Gemini AI</p>
                    </div>
                </div>
                <button id="closeModal" class="text-white/80 hover:text-white text-2xl transition-colors">‚úï</button>
            </div>
            <div class="p-6 overflow-y-auto max-h-[calc(80vh-180px)]">
                <div class="grid grid-cols-2 gap-3 mb-6">
                    <button onclick="askAI('explain')" class="p-3 bg-amber-50 hover:bg-amber-100 border border-amber-200 rounded-xl text-xs font-bold text-amber-700 transition-all">
                        üìö ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î
                    </button>
                    <button onclick="askAI('example')" class="p-3 bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-xl text-xs font-bold text-blue-700 transition-all">
                        üí° ‡∏¢‡∏Å‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
                    </button>
                    <button onclick="askAI('problem')" class="p-3 bg-green-50 hover:bg-green-100 border border-green-200 rounded-xl text-xs font-bold text-green-700 transition-all">
                        üéØ ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢
                    </button>
                    <button onclick="askAI('realworld')" class="p-3 bg-purple-50 hover:bg-purple-100 border border-purple-200 rounded-xl text-xs font-bold text-purple-700 transition-all">
                        üåç ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á
                    </button>
                </div>
                <div id="aiResponse" class="text-sm text-stone-600 leading-relaxed bg-stone-50 p-5 rounded-xl border border-stone-200 ai-content">
                    <p class="text-center opacity-30 py-8 italic text-xs">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö AI</p>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-white border-t border-stone-200 py-4 mt-12">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-xs text-stone-500">Math Explorer Pro ‚Ä¢ Powered by Gemini AI ‚Ä¢ <span id="symbolCount">0</span> ‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå</p>
        </div>
    </footer>

    <script>

        const GEMINI_API_KEY = 'AIzaSyDLVAl9YqyJK3lSDXWp4-P6tAt-5IEV1Go'; // ‚ö†Ô∏è ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏ß‡∏¢ API Key ‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
        const modelName = 'gemini-3-flash-preview';
        
        let currentSymbolContext = null;

        // ========================================
        // üìä SYMBOL DATA
        // ========================================
        const symbolData = [
            { s: "‚àë", en: "Summation", th: "‡∏ú‡∏•‡∏£‡∏ß‡∏°", desc: "sigma", cat: "Special" },
            { s: "‚àè", en: "Product", th: "‡∏ú‡∏•‡∏Ñ‡∏π‡∏ì", desc: "pi", cat: "Special" },
            { s: "‚àû", en: "Infinity", th: "‡∏≠‡∏ô‡∏±‡∏ô‡∏ï‡πå", desc: "", cat: "Special" },
            { s: "‚àÄ", en: "For All", th: "‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å", desc: "", cat: "Logic" },
            { s: "‚àÉ", en: "Exists", th: "‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà", desc: "", cat: "Logic" },
            { s: "‚àÑ", en: "Not Exists", th: "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà", desc: "", cat: "Logic" },
            { s: "‚áí", en: "Implies", th: "‡∏ô‡∏±‡∏¢‡∏ß‡πà‡∏≤", desc: "", cat: "Logic" },
            { s: "‚áî", en: "Iff", th: "‡∏Å‡πá‡∏ï‡πà‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠", desc: "", cat: "Logic" },
            { s: "¬¨", en: "Not", th: "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", desc: "", cat: "Logic" },
            { s: "‚àß", en: "And", th: "‡πÅ‡∏•‡∏∞", desc: "", cat: "Logic" },
            { s: "‚à®", en: "Or", th: "‡∏´‡∏£‡∏∑‡∏≠", desc: "", cat: "Logic" },
            { s: "‚àà", en: "Element of", th: "‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å", desc: "", cat: "Set Theory" },
            { s: "‚àâ", en: "Not Element of", th: "‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å", desc: "", cat: "Set Theory" },
            { s: "‚äÜ", en: "Subset", th: "‡∏™‡∏±‡∏ö‡πÄ‡∏ã‡∏ï", desc: "", cat: "Set Theory" },
            { s: "‚äÇ", en: "Proper Subset", th: "‡∏™‡∏±‡∏ö‡πÄ‡∏ã‡∏ï‡πÅ‡∏ó‡πâ", desc: "", cat: "Set Theory" },
            { s: "‚à™", en: "Union", th: "‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡∏¢‡∏ô", desc: "", cat: "Set Theory" },
            { s: "‚à©", en: "Intersection", th: "‡∏≠‡∏¥‡∏ô‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏Å", desc: "", cat: "Set Theory" },
            { s: "‚àÖ", en: "Empty Set", th: "‡πÄ‡∏ã‡∏ï‡∏ß‡πà‡∏≤‡∏á", desc: "null", cat: "Set Theory" },
            { s: "‚Ñï", en: "Natural", th: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏ö", desc: "", cat: "Number Sets" },
            { s: "‚Ñ§", en: "Integer", th: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ï‡πá‡∏°", desc: "", cat: "Number Sets" },
            { s: "‚Ñö", en: "Rational", th: "‡∏ï‡∏£‡∏£‡∏Å‡∏¢‡∏∞", desc: "", cat: "Number Sets" },
            { s: "‚Ñù", en: "Real", th: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏£‡∏¥‡∏á", desc: "", cat: "Number Sets" },
            { s: "‚ÑÇ", en: "Complex", th: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡∏ã‡πâ‡∏≠‡∏ô", desc: "", cat: "Number Sets" },
            { s: "‚âà", en: "Approx", th: "‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì", desc: "", cat: "Comparison" },
            { s: "‚â†", en: "Not Equal", th: "‡πÑ‡∏°‡πà‡πÄ‡∏ó‡πà‡∏≤", desc: "", cat: "Comparison" },
            { s: "‚â§", en: "Less Equal", th: "‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤", desc: "", cat: "Comparison" },
            { s: "‚â•", en: "Greater Equal", th: "‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤", desc: "", cat: "Comparison" },
            { s: "‚â™", en: "Much Less", th: "‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏°‡∏≤‡∏Å", desc: "", cat: "Comparison" },
            { s: "‚â´", en: "Much Greater", th: "‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏°‡∏≤‡∏Å", desc: "", cat: "Comparison" },
            { s: "‚àù", en: "Proportional", th: "‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô", desc: "", cat: "Comparison" },
            { s: "‚àö", en: "Square Root", th: "‡∏£‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á", desc: "", cat: "Special" },
            { s: "‚àõ", en: "Cube Root", th: "‡∏£‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°", desc: "", cat: "Special" },
            { s: "œÄ", en: "Pi", th: "‡πÑ‡∏û", desc: "3.14159...", cat: "Special" },
            { s: "e", en: "Euler", th: "‡∏≠‡∏µ‡∏≠‡∏≠‡∏¢‡πÄ‡∏•‡∏≠‡∏£‡πå", desc: "2.718...", cat: "Special" },
            { s: "‚à´", en: "Integral", th: "‡∏≠‡∏¥‡∏ô‡∏ó‡∏¥‡∏Å‡∏£‡∏±‡∏•", desc: "", cat: "Calculus" },
            { s: "‚àÇ", en: "Partial", th: "‡∏î‡∏¥‡∏ü‡∏¢‡πà‡∏≠‡∏¢", desc: "", cat: "Calculus" },
            { s: "‚àÜ", en: "Delta", th: "‡πÄ‡∏î‡∏•‡∏ï‡∏≤", desc: "‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á", cat: "Calculus" },
            { s: "‚àá", en: "Nabla", th: "‡∏ô‡∏≤‡∏ö‡∏•‡∏≤", desc: "‡πÄ‡∏Å‡∏£‡πÄ‡∏î‡∏µ‡∏¢‡∏ô‡∏ï‡πå", cat: "Calculus" },
            { s: "‚Üí", en: "Vector", th: "‡πÄ‡∏ß‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå", desc: "", cat: "Vectors" },
            { s: "‚Äñv‚Äñ", en: "Norm", th: "‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏ß‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå", desc: "", cat: "Vectors" },
            { s: "det", en: "Determinant", th: "‡∏î‡∏µ‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏°‡∏¥‡πÅ‡∏ô‡∏ô‡∏ï‡πå", desc: "", cat: "Vectors" },
            { s: "T", en: "Transpose", th: "‡∏ó‡∏£‡∏≤‡∏ô‡∏™‡πÇ‡∏û‡∏™", desc: "", cat: "Vectors" },
            { s: "¬∑", en: "Dot Product", th: "‡∏î‡∏≠‡∏ó", desc: "", cat: "Vectors" },
            { s: "√ó", en: "Cross Product", th: "‡∏Ñ‡∏£‡∏≠‡∏™", desc: "", cat: "Vectors" },
            { s: "‚à†", en: "Angle", th: "‡∏°‡∏∏‡∏°", desc: "", cat: "Geometry" },
            { s: "‚ñ≥", en: "Triangle", th: "‡∏™‡∏≤‡∏°‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°", desc: "", cat: "Geometry" },
            { s: "‚à•", en: "Parallel", th: "‡∏Ç‡∏ô‡∏≤‡∏ô", desc: "", cat: "Geometry" },
            { s: "‚ä•", en: "Perpendicular", th: "‡∏ï‡∏±‡πâ‡∏á‡∏â‡∏≤‡∏Å", desc: "", cat: "Geometry" },
            { s: "¬∞", en: "Degree", th: "‡∏≠‡∏á‡∏®‡∏≤", desc: "", cat: "Geometry" },
            { s: "‚âÖ", en: "Congruent", th: "‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏£", desc: "", cat: "Geometry" },
            { s: "‚à£", en: "Divides", th: "‡∏´‡∏≤‡∏£‡∏•‡∏á‡∏ï‡∏±‡∏ß", desc: "", cat: "Number Theory" },
            { s: "‚à§", en: "No divide", th: "‡πÑ‡∏°‡πà‡∏•‡∏á‡∏ï‡∏±‡∏ß", desc: "", cat: "Number Theory" },
            { s: "‚â°", en: "Congruence", th: "‡∏™‡∏°‡∏†‡∏≤‡∏Ñ", desc: "mod", cat: "Number Theory" },
            { s: "gcd", en: "GCD", th: "‡∏´.‡∏£.‡∏°.", desc: "", cat: "Number Theory" },
            { s: "lcm", en: "LCM", th: "‡∏Ñ.‡∏£.‡∏ô.", desc: "", cat: "Number Theory" },
            { s: "f(x)", en: "Function", th: "‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô", desc: "", cat: "Functions" },
            { s: "log", en: "Log", th: "‡∏•‡∏≠‡∏Å‡∏≤‡∏£‡∏¥‡∏ó‡∏∂‡∏°", desc: "", cat: "Functions" },
            { s: "ln", en: "Natural Log", th: "ln", desc: "", cat: "Functions" },
            { s: "sin", en: "Sine", th: "‡πÑ‡∏ã‡∏ô‡πå", desc: "", cat: "Functions" },
            { s: "‚ä¢", en: "Turnstile", th: "‡∏û‡∏¥‡∏™‡∏π‡∏à‡∏ô‡πå‡πÑ‡∏î‡πâ", desc: "", cat: "Adv Logic" },
            { s: "‚ä®", en: "Double Turnstile", th: "‡∏™‡∏°‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏°‡∏ú‡∏•", desc: "", cat: "Adv Logic" }
        ];

        let currentCategory = 'All';
        let searchQuery = '';
        let quizMode = false;
        const categories = ['All', ...new Set(symbolData.map(d => d.cat))];

        const gridContainer = document.getElementById('gridContainer');
        const categoryContainer = document.getElementById('categoryContainer');
        const searchInput = document.getElementById('searchInput');
        const emptyState = document.getElementById('emptyState');
        const quizToggle = document.getElementById('quizToggle');
        const quizText = document.getElementById('quizText');
        const body = document.body;
        const aiModal = document.getElementById('aiModal');
        const aiModalContent = document.getElementById('aiModalContent');
        const closeModalBtn = document.getElementById('closeModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalSymbolIcon = document.getElementById('modalSymbolIcon');
        const aiResponse = document.getElementById('aiResponse');
        const modelLabel = document.getElementById('modelLabel');
        const symbolCount = document.getElementById('symbolCount');

        // ========================================
        // ü§ñ GEMINI API FUNCTIONS
        // ========================================
        
        async function callGeminiAPI(prompt) {
            if (GEMINI_API_KEY === 'YOUR_API_KEY_HERE') {
                return '‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà Gemini API Key ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 233)\n\n‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö API Key:\n1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà https://makersuite.google.com/app/apikey\n2. ‡∏™‡∏£‡πâ‡∏≤‡∏á API Key ‡πÉ‡∏´‡∏°‡πà\n3. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏°‡∏≤‡πÉ‡∏™‡πà‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ GEMINI_API_KEY';
            }

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${modelName}:generateContent?key=${GEMINI_API_KEY}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }] }],
                        generationConfig: {
                            temperature: 0.7,
                            maxOutputTokens: 1024,
                        }
                    })
                });

                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error?.message || 'API Error');
                }

                const data = await response.json();
                return data.candidates[0].content.parts[0].text;
            } catch (error) {
                console.error('Gemini API Error:', error);
                return `‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}\n\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:\n1. API Key ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà\n2. ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà\n3. API Quota ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà`;
            }
        }

        async function askAI(mode) {
            if (!currentSymbolContext) return;
            
            const item = currentSymbolContext;
            const modes = {
                'explain': `‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏ó‡∏≤‡∏á‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå "${item.s}" (${item.en} / ${item.th}) ‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏á‡πà‡∏≤‡∏¢ ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏° ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ö‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏°‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢`,
                'example': `‡∏¢‡∏Å‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå "${item.s}" (${item.en}) ‡πÉ‡∏ô‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå 2-3 ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏â‡∏•‡∏¢`,
                'problem': `‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö "${item.s}" (${item.en}) ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏•‡∏≤‡∏á‡∏ñ‡∏∂‡∏á‡∏¢‡∏≤‡∏Å 1 ‡∏Ç‡πâ‡∏≠ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ`,
                'realworld': `‡∏ö‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏≥ "${item.s}" (${item.en}) ‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏à‡∏£‡∏¥‡∏á ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå ‡∏´‡∏£‡∏∑‡∏≠‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°`
            };

            const prompt = modes[mode] || modes['explain'];
            
            aiResponse.innerHTML = `<div class="text-center py-8"><div class="inline-block animate-spin text-3xl">‚öôÔ∏è</div><p class="text-xs text-stone-400 mt-3 loading-dots">AI ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏¥‡∏î</p></div>`;
            
            const result = await callGeminiAPI(prompt);
            aiResponse.innerHTML = `<div class="prose prose-sm max-w-none">${formatAIResponse(result)}</div>`;
            
            // Render LaTeX if present
            if (window.MathJax) {
                MathJax.typesetPromise([aiResponse]).catch(err => console.log('MathJax error:', err));
            }
        }

        async function generateRoadmap() {
            const roadmapSection = document.getElementById('roadmapSection');
            const roadmapResult = document.getElementById('roadmapResult');
            const roadmapCategoryName = document.getElementById('roadmapCategoryName');
            
            const catDisplay = currentCategory === 'All' ? '‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ' : currentCategory;
            roadmapCategoryName.textContent = catDisplay;
            
            roadmapSection.classList.remove('hidden');
            roadmapResult.innerHTML = `<div class="text-center py-8"><div class="inline-block animate-spin text-3xl">‚öôÔ∏è</div><p class="text-xs text-stone-400 mt-3 loading-dots">AI ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p></div>`;
            
            const prompt = `‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ (Roadmap) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ "${catDisplay}" ‡πÇ‡∏î‡∏¢‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£ ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°`;
            
            const result = await callGeminiAPI(prompt);
            roadmapResult.innerHTML = formatAIResponse(result);
        }

        function closeRoadmap() {
            document.getElementById('roadmapSection').classList.add('hidden');
        }

        function formatAIResponse(text) {
            // Convert markdown-like formatting to HTML
            return text
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                .replace(/^### (.*$)/gim, '<h3 class="text-base font-bold text-amber-600 mt-4 mb-2">$1</h3>')
                .replace(/^## (.*$)/gim, '<h2 class="text-lg font-bold text-amber-700 mt-4 mb-2">$1</h2>')
                .replace(/^# (.*$)/gim, '<h1 class="text-xl font-bold text-amber-800 mt-4 mb-2">$1</h1>')
                .replace(/\n\n/g, '</p><p class="mb-3">')
                .replace(/^- (.*$)/gim, '<li>$1</li>')
                .replace(/(<li>.*<\/li>)/s, '<ul class="list-disc ml-6 mb-3">$1</ul>')
                .replace(/^\d+\. (.*$)/gim, '<li>$1</li>')
                .trim();
        }

        // ========================================
        // üé® UI RENDERING FUNCTIONS
        // ========================================

        function renderCategories() {
            modelLabel.textContent = modelName.toUpperCase();
            categoryContainer.innerHTML = categories.map(cat => {
                const isActive = currentCategory === cat;
                const activeClass = isActive ? 'bg-amber-500 text-white shadow-md' : 'bg-white text-stone-600 border border-stone-200';
                const thaiNames = { 
                    'All': '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î', 
                    'Number Sets': '‡πÄ‡∏ã‡∏ï‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç', 
                    'Set Theory': '‡πÄ‡∏ã‡∏ï', 
                    'Logic': '‡∏ï‡∏£‡∏£‡∏Å‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå', 
                    'Comparison': '‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö', 
                    'Special': '‡∏û‡∏¥‡πÄ‡∏®‡∏©', 
                    'Calculus': '‡πÅ‡∏Ñ‡∏•‡∏Ñ‡∏π‡∏•‡∏±‡∏™', 
                    'Vectors': '‡πÄ‡∏ß‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå', 
                    'Geometry': '‡πÄ‡∏£‡∏Ç‡∏≤‡∏Ñ‡∏ì‡∏¥‡∏ï', 
                    'Number Theory': '‡∏ó‡∏§‡∏©‡∏é‡∏µ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô', 
                    'Functions': '‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô', 
                    'Adv Logic': '‡∏ï‡∏£‡∏£‡∏Å‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏™‡∏π‡∏á' 
                };
                return `<button onclick="setCategory('${cat}')" class="${activeClass} px-3 py-1.5 rounded-lg text-xs font-bold whitespace-nowrap transition-all">${thaiNames[cat] || cat}</button>`;
            }).join('');
        }

        function renderGrid() {
            gridContainer.innerHTML = '';
            const filtered = symbolData.filter(item => {
                const matchesCat = currentCategory === 'All' || item.cat === currentCategory;
                const query = searchQuery.toLowerCase();
                return matchesCat && (item.s.toLowerCase().includes(query) || item.en.toLowerCase().includes(query) || item.th.toLowerCase().includes(query));
            });
            
            if (filtered.length === 0) {
                emptyState.classList.remove('hidden');
            } else {
                emptyState.classList.add('hidden');
                filtered.forEach((item, index) => {
                    const card = document.createElement('div');
                    card.className = `symbol-card bg-white p-5 rounded-2xl border border-stone-100 flex flex-col items-center text-center group h-full justify-between`;
                    card.innerHTML = `
                        <div class="mb-4 h-16 flex items-center justify-center">
                            <span class="text-4xl font-serif text-stone-800">${item.s}</span>
                        </div>
                        <div class="w-full space-y-1 mb-4">
                            <h3 class="text-base font-bold text-amber-600 name-en">${item.en}</h3>
                            <p class="text-stone-700 font-semibold meaning text-xs">${item.th}</p>
                        </div>
                        <button onclick="openAiModal(${index})" class="w-full py-2 bg-amber-50 hover:bg-amber-100 text-amber-700 text-[10px] font-bold rounded-lg transition-colors border border-amber-100">‚ú® ‡∏ñ‡∏≤‡∏° AI</button>
                    `;
                    gridContainer.appendChild(card);
                });
            }
            
            symbolCount.textContent = symbolData.length;
        }

        function setCategory(cat) { 
            currentCategory = cat; 
            renderCategories(); 
            renderGrid(); 
        }

        function openAiModal(index) {
            const filtered = symbolData.filter(item => {
                const matchesCat = currentCategory === 'All' || item.cat === currentCategory;
                const query = searchQuery.toLowerCase();
                return matchesCat && (item.s.toLowerCase().includes(query) || item.en.toLowerCase().includes(query) || item.th.toLowerCase().includes(query));
            });
            const item = filtered[index];
            currentSymbolContext = item;
            modalTitle.textContent = `${item.en} (${item.th})`;
            modalSymbolIcon.textContent = item.s;
            aiResponse.innerHTML = `<p class="text-center opacity-30 py-8 italic text-xs">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö AI</p>`;
            aiModal.classList.remove('hidden');
            setTimeout(() => { 
                aiModalContent.classList.remove('scale-95', 'opacity-0'); 
                aiModalContent.classList.add('scale-100', 'opacity-100'); 
            }, 10);
        }

        function closeModal() {
            aiModalContent.classList.remove('scale-100', 'opacity-100');
            aiModalContent.classList.add('scale-95', 'opacity-0');
            setTimeout(() => { aiModal.classList.add('hidden'); }, 300);
            currentSymbolContext = null;
        }

        // ========================================
        // üìä CHART INITIALIZATION
        // ========================================

        function initChart() {
            const ctx = document.getElementById('distributionChart').getContext('2d');
            const counts = {};
            symbolData.forEach(item => { 
                counts[item.cat] = (counts[item.cat] || 0) + 1; 
            });
            const labels = categories.filter(c => c !== 'All');
            const data = labels.map(cat => counts[cat]);
            
            new Chart(ctx, {
                type: 'bar',
                data: { 
                    labels: labels, 
                    datasets: [{ 
                        label: 'Symbols', 
                        data: data, 
                        backgroundColor: '#fbbf24', 
                        borderRadius: 4 
                    }] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    plugins: { legend: { display: false } }, 
                    scales: { 
                        y: { beginAtZero: true }, 
                        x: { ticks: { font: { size: 9 } } } 
                    } 
                }
            });
        }

        // ========================================
        // üéÆ EVENT LISTENERS
        // ========================================

        searchInput.addEventListener('input', (e) => { 
            searchQuery = e.target.value; 
            renderGrid(); 
        });

        quizToggle.addEventListener('click', () => {
            quizMode = !quizMode;
            if (quizMode) { 
                body.classList.add('quiz-mode'); 
                quizToggle.classList.replace('bg-stone-100', 'bg-amber-500'); 
                quizToggle.classList.replace('text-stone-600', 'text-white'); 
                quizText.textContent = "‡∏õ‡∏¥‡∏î‡πÇ‡∏´‡∏°‡∏î‡∏ó‡πà‡∏≠‡∏á‡∏à‡∏≥"; 
            } else { 
                body.classList.remove('quiz-mode'); 
                quizToggle.classList.replace('bg-amber-500', 'bg-stone-100'); 
                quizToggle.classList.replace('text-white', 'text-stone-600'); 
                quizText.textContent = "‡πÇ‡∏´‡∏°‡∏î‡∏ó‡πà‡∏≠‡∏á‡∏à‡∏≥ (Quiz Mode)"; 
            }
        });

        closeModalBtn.addEventListener('click', closeModal);

        // ========================================
        // üöÄ INITIALIZE APP
        // ========================================

        renderCategories();
        renderGrid();
        initChart();
    </script>
</body>
</html>
